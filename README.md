# kbHealth
----
### 1. 기능 요구 사항

* **사용자의 최종 개인 점수 계산**
    - 사용자의 식단 기록, 운동 기록을 통해 점수를 계산할 수 있다.
    - 일일 점수는 전날의 식단 및 운동 기록을 바탕으로 계산되며, 매일 00시에 자동 갱신된다.
    - 사용자의 기본 점수는 최근 10일간의 일일 점수에 가중치를 적용해 100점 만점 기준으로 산정된다.
    - 일일 점수 산정 기준:
        - **식단 점수**
            - 사용자의 하루 권장 영양소와 실제 섭취량을 비교해 다음 기준에 따라 산정한다:
                - 칼로리: 권장량 대비 ±10% 이내 → +20점, 초과/미달 → 점수 감소
                - 단백질: 권장량의 90% 이상 → +10점
                - 지방: 권장량 초과 → -5점
                - 당류: 25g 초과 → -5점
                - 나트륨: 2000mg 초과 → -5점
                - 식이섬유: 권장량 이상 → +5점
            - **권장 영양소 정보**: 권장 영양소에는 다음 항목이 포함된다.
                - 권장 영양소는 사용자의 성별, 몸무게를 기반으로 자동 생성된다.
                - 관리 항목:
                    - 하루 권장 칼로리
                    - 단백질(g), 지방(g), 탄수화물(g), 당류(g), 나트륨(mg), 식이섬유(g) 등
        - **운동 점수**
            - 사용자가 해당 날짜에 목표 운동량(예: 30분 이상 또는 200kcal 이상)을 달성한 경우, 식단 점수를 전부 반영한다.
            - 목표를 달성하지 못한 경우, 식단 점수의 일정 비율만 반영한다 (예: 70%).

* **랭킹**
    - 랭킹은 매일 00시 기준으로 자동 갱신된다.
    - 랭킹은 사용자의 기본 점수를 바탕으로 산출된다.
        - 기본 점수는 최근 10일간의 일일 점수를 가중치 계산하여 책정된다.
    - 랭킹은 다음과 같은 방식으로 제공된다:
        - 전체 사용자 중 상위 N명의 랭킹 (예: TOP 100)
        - 성별, 연령대별, 친구(팔로우)끼리의 필터 기반 랭킹
    - 사용자 탈퇴 시 랭킹에서 제외된다.
    - 동일한 점수를 가진 사용자는 가입 순서에 따라 순위가 결정된다.
    - 자신의 랭킹은 마이페이지 혹은 대시보드에서 확인할 수 있다.
    - 랭킹에는 다음 정보가 포함된다:
        - 순위
        - 사용자 닉네임
        - 프로필 이미지
        - 기본 점수

* **음식 관리**
    - 기본 음식은 서버를 시작할 때 DB에 함께 삽입된다.
    - 사용자가 원하는 음식이 없을 경우, 음식을 추가할 수 있다.

* **식단 기록 관리**
    - 사용자는 음식과 식사 분류(아침,점심,저녁,간식)을 선택해서 식단을 기록할 수 있다.
    - 사용자는 식단을 수정하거나 삭제할 수 있다.
    - 해당 일자가 지나면 식단 기록은 수정 및 삭제할 수 없다.
    - 하나의 식단 기록에는 하나의 음식만 연결되며, 여러 기록을 추가해 하루 섭취량을 구성한다.

* **운동 기록 관리**
    - 사용자는 운동 종류(유산소, 근력 등), 소요 시간, 소모 칼로리를 입력하여 운동 기록을 추가할 수 있다.
    - 사용자는 운동 기록을 수정하거나 삭제할 수 있다.
    - 해당 일자가 지나면 운동 기록은 수정 및 삭제할 수 없다.
    - 운동 기록은 하루 단위로 집계되며, 목표 운동량 달성 여부 판단에 활용된다.

* **팔로우**
    - 사용자는 다른 사용자를 팔로우할 수 있다.
    - 사용자는 팔로우한 사용자를 언팔로우(팔로우 취소)할 수 있다.
    - 한 사용자가 탈퇴하면, 해당 사용자가 팔로우한 기록과 팔로워 기록이 모두 삭제된다.
    - 사용자는 이미 팔로우 중인 사용자를 다시 팔로우할 수 없다.
    - 자기 자신을 팔로우하는 것은 불가능하다.
    - 팔로우 목록은 다음과 같이 조회할 수 있다:
        - 특정 사용자의 팔로워 목록 (나를 팔로우하는 사용자들)
        - 특정 사용자의 팔로잉 목록 (내가 팔로우하는 사용자들)

* **커뮤니티**
  - **게시판**



* **예외 처리**
    - 사용자가 잘못된 값을 입력할 경우 적절한 `Exception`을 발생시키고, 오류 메시지를 출력.
    - 오류 메시지는 각 예외에 맞는 유형을 처리해야 하며, `IllegalArgumentException`, `IllegalStateException` 등을 사용한다。

----------
### 2. 기능 구현 단위

### `RecordController` (기록 관련)

| 기능         | HTTP 메서드 | URI                             |
| ------------ | ----------- | -------------------------------- |
| 식단 목록 조회   | GET         | `/api/records/diet`             |
| 식단 생성        | POST        | `/api/records/diet`             |
| 식단 단건 조회   | GET         | `/api/records/diet/{drId}`      |
| 식단 수정        | PUT         | `/api/records/diet/{drId}`      |
| 식단 삭제        | DELETE      | `/api/records/diet/{drId}`      |
| 운동 목록 조회   | GET         | `/api/records/exercise`         |
| 운동 생성        | POST        | `/api/records/exercise`         |
| 운동 단건 조회   | GET         | `/api/records/exercise/{exId}`  |
| 운동 수정        | PUT         | `/api/records/exercise/{exId}`  |
| 운동 삭제        | DELETE      | `/api/records/exercise/{exId}`  |

---

### `AuthController` (회원 인증 관련)

| 기능         | HTTP 메서드 | URI                |
| ------------ | ----------- | ------------------ |
| 로그인       | POST        | `/api/auth/login`  |
| 로그아웃     | GET         | `/api/auth/logout` |
| 회원가입     | POST        | `/api/auth/regist` |

---

### `FollowController` (팔로우/팔로워 관리)

| 기능               | HTTP 메서드 | URI                               |
| ------------------ | ----------- | --------------------------------- |
| 팔로우             | POST        | `/api/follow/following/{member_id}` |
| 언팔로우           | DELETE      | `/api/follow/following/{member_id}` |
| 팔로잉 목록 조회   | GET         | `/api/follow/followingList/{member_id}` |
| 팔로워 목록 조회   | GET         | `/api/follow/followerList/{member_id}` |

---

### `ItemController` (식단 관련)

| 기능             | HTTP 메서드 | URI                        |
| ---------------- | ----------- | -------------------------- |
| 식단 목록 조회   | GET         | `/api/items`               |
| 식단 추가        | POST        | `/api/items`               |
| 특정 식단 조회   | GET         | `/api/items/{dietId}`      |
| 식단 수정        | PUT         | `/api/items/{dietId}`      |
| 식단 삭제        | DELETE      | `/api/items/{dietId}`      |

---

### `ProfileController` (회원 프로필 관련)

| 기능         | HTTP 메서드 | URI                              |
| ------------ | ----------- | --------------------------------- |
| 프로필 조회   | GET         | `/api/profile/{member_account}`   |
| 프로필 수정   | POST        | `/api/profile/edit`              |    

 ----
### 3. 예외 처리


----
### 4. 수정사항

* 테스트케이스
    - FollowTest: 팔로우 기능 테스트
    - MemberTest: 회원 기능 테스트
    - DietTest: 음식과 식단기록 기능 테스트
    - ExerciseTest: 운동 기록 기능 테스트